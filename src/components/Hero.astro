---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const rawTitle = t('hero.title');
const formattedTitle = rawTitle
    .split('|')
    .map(line => {
        const trimmed = line.trim();
        const content = line.replace(/\*(.*?)\*/g, '<span class="hero-accent">$1</span>');
        // Если строка пустая, вставляем неразрывный пробел, чтобы она имела высоту
        return trimmed === '' ? '&nbsp;' : content;
    })
    .join('<br/>');
const cleanTitle = rawTitle.replace(/[|*]/g, '');
---
<section class="hero" itemscope itemtype="https://schema.org/Person" style={`background-image: url('${import.meta.env.BASE_URL.replace(/\/$/, '')}/hero.webp')`}>
    <meta itemprop="name" content="Alexander Finaev" />
    <meta itemprop="url" content={Astro.url.href} />
    <meta itemprop="image" content={`${import.meta.env.BASE_URL.replace(/\/$/, '')}/hero.webp`} />
    <meta itemprop="jobTitle" content={cleanTitle} />
    
	<div class="container hero-container">
		<div class="hero-content reveal">
			<h1 class="hero-title" set:html={formattedTitle}>
			</h1>
			<div class="hero-description-wrapper">
                <p class="hero-description" itemprop="description">
                    {t('hero.desc')}
                </p>
            </div>
		</div>
	</div>
</section>

<style>
	.hero {
		display: flex;
		flex-direction: column;
		justify-content: flex-start; /* ОБЯЗАТЕЛЬНО для смещения ВВЕРХ в колонке */
		align-items: flex-start; /* Смещение ВЛЕВО */
		min-height: 100vh;
		background-repeat: no-repeat;
        background-position: center bottom;
        background-size: cover;
		position: relative;
		padding: 0 0 4rem; /* Убрал верхний padding, чтобы фон шел от края */
		overflow: hidden;
	}

	.hero-container {
        width: 100%;
        display: flex;
        justify-content: flex-start;
        margin-left: 0;
        max-width: 100%; /* Убираем ограничение ширины для этого контейнера */
        padding-left: 5rem; /* Синхронизировано с хедером */
        padding-top: 4rem; /* Отступ для текста от верхнего края экрана */
    }

	.hero-content {
		position: relative;
		z-index: 2;
		width: 100%;
		max-width: 1000px;
        text-align: left;
        margin-top: 2vh; /* Небольшая корректировка для визуальной гармонии с меню */
	}

	.hero-title {
        font-family: var(--font-heading);
		font-weight: 700; /* Oswald любит жирное начертание */
		font-size: clamp(2.65rem, 8.5vw, 6.6rem); /* Увеличено на ~20% */
		text-transform: uppercase;
		margin-bottom: 2rem;
		letter-spacing: -0.03em; /* Буквы плотнее */
		line-height: 1.1; /* Интервал между строк больше */
		color: var(--color-heading);
	}

	:global(.hero-accent) {
		color: var(--color-hero-accent);
	}

    .hero-description-wrapper {
        border-left: 3px solid var(--color-heading);
        padding-left: 2rem;
        margin-bottom: 2.5rem;
        max-width: 550px;
    }

	.hero-description {
		font-size: clamp(0.95rem, 1.1vw, 1.2rem); /* Уменьшено: было clamp(1rem, 1.2vw, 1.3rem) */
		color: var(--color-text-muted);
		line-height: 1.4;
        font-weight: 400;
	}

	.hero-actions {
		display: flex;
		justify-content: flex-start;
	}

    .cta-button {
        background-color: var(--color-heading);
        color: var(--color-bg);
        border-radius: 0;
        padding: 1rem 3rem;
    }

	/* Адаптация для средних экранов (ноутбуки 1024px-1440px) */
	@media (min-width: 1025px) and (max-width: 1440px) {
		.hero {
			background-position: 70% center; /* Смещаем фон вправо, чтобы лицо не мешало тексту */
		}

		.hero-content {
			max-width: 700px; /* Уменьшаем ширину контента */
		}

		.hero-title {
			font-size: clamp(2.2rem, 7vw, 5.5rem);
		}

		.hero-description-wrapper {
			max-width: 450px;
		}
	}

	/* Планшеты и маленькие ноутбуки */
	@media (max-width: 1024px) {
		.hero-title {
			font-size: clamp(2.5rem, 12vw, 6rem);
		}
	}

	@media (max-width: 768px) {
		.hero {
			min-height: 80vh;
			padding: 6rem 1.5rem 4rem;
            align-items: center; /* На мобилках лучше по центру */
		}

        .hero-container {
            justify-content: center;
            padding-left: 0;
        }

        .hero-content {
            text-align: center;
            margin-top: 0;
        }

		.hero-title {
			margin-bottom: 2rem;
		}

        .hero-description-wrapper {
            border-left: none;
            border-top: 2px solid var(--color-heading);
            padding: 1.5rem 0 0;
            margin: 0 auto 2.5rem;
        }

        .hero-actions {
            justify-content: center;
        }
	}
</style>
