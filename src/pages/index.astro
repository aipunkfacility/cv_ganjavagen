---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Method from '../components/Method.astro';
import Competencies from '../components/Competencies.astro';
import LocalSolutions from '../components/LocalSolutions.astro';
import CTASection from '../components/CTASection.astro';
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<script is:inline define:vars={{ base: import.meta.env.BASE_URL }}>
  // Редирект на основе языка браузера для статического режима
  const savedLang = localStorage.getItem('preferred-lang');
  const normalizedBase = base.endsWith('/') ? base : base + '/';
  if (!savedLang && (window.location.pathname === base || window.location.pathname === base.replace(/\/$/, ''))) {
    const browserLang = navigator.language.split('-')[0];
    if (browserLang === 'vi' || browserLang === 'vn') {
      window.location.href = `${normalizedBase}vn/`;
    } else if (browserLang !== 'ru') {
      window.location.href = `${normalizedBase}en/`;
    }
  }
</script>

<Layout title={t('hero.title') + " — Alexander Finaev"}>
	<Hero />
	<About />
	<Method />
	<Competencies />
	<LocalSolutions />
	<CTASection />
</Layout>
